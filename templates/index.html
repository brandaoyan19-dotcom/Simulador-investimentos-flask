<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Simulador de Investimentos</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        function atualizarCampos() {
            const tipo = document.getElementById("tipo").value;

            document.getElementById("campo-ipca").style.display = "none";
            document.getElementById("campo-cdi").style.display = "none";

            if (tipo === "ipca") {
                document.getElementById("campo-ipca").style.display = "block";
            }

            if (tipo === "cdb") {
                document.getElementById("campo-cdi").style.display = "block";
            }
        }
    </script>
    <body>

<div class="app">

    <!-- FORMULÁRIO -->
    <div class="card">
        <h1>Simulador de Investimentos</h1>
        <p class="sub">Aprenda, simule e compare investimentos</p>

        <form method="POST">

            <label>Valor inicial (R$)</label>
            <input type="number" name="valor_inicial" required>

            <label>Aporte mensal (R$)</label>
            <input type="number" name="aporte_mensal" required>

            <label>Período (anos)</label>
            <input type="number" name="anos" required>

            <label>Tipo de investimento</label>
            <select name="tipo" required>
                <option value="">Selecione</option>
                <option value="selic">Tesouro Selic</option>
                <option value="ipca">Tesouro IPCA+</option>
                <option value="cdb">CDB</option>
            </select>

            <!-- IPCA+ -->
            <div id="ipcaExtra" style="display:none;">
                <label>Adicional do IPCA+ (% ao ano)</label>
                <input type="number" step="0.01" name="ipca_extra">
                <small class="educativo">
                    Exemplo: IPCA + 5% significa inflação + 5% ao ano
                </small>
            </div>

            <!-- CDB -->
            <div id="cdbExtra" style="display:none;">
                <label>Percentual do CDI (%)</label>
                <input type="number" step="1" name="cdb_percentual">
                <small class="educativo">
                    Exemplo: 110% do CDI costuma render mais que a poupança
                </small>
            </div>

            <button type="submit">Simular</button>
        </form>
    </div>

    <!-- RESULTADO -->
    {% if resultado and not resultado.erro %}
    <div class="card">
        <h2>Resultado da simulação</h2>

        <div class="resultado">
            <p><strong>Total investido:</strong> R$ {{ resultado.investido }}</p>
            <p><strong>Valor final:</strong> R$ {{ resultado.final }}</p>
            <p><strong>Lucro:</strong> R$ {{ resultado.lucro }}</p>
            <p><strong>Rendimento:</strong> {{ resultado.percentual }}%</p>

            <p><strong>{{ resultado.avaliacao }}</strong></p>

            <div class="educativo">
                <p>
                    Quanto maior o tempo investido, maior o impacto dos juros compostos.
                    A constância costuma ser mais importante do que tentar “acertar o melhor momento”.
                </p>
            </div>
        </div>
    </div>
    {% endif %}

</div>

<script>
const tipo = document.querySelector('select[name="tipo"]');
const ipca = document.getElementById('ipcaExtra');
const cdb = document.getElementById('cdbExtra');

tipo.addEventListener('change', () => {
    ipca.style.display = tipo.value === 'ipca' ? 'block' : 'none';
    cdb.style.display = tipo.value === 'cdb' ? 'block' : 'none';
});
</script>

</body>
</html>